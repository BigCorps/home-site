<!DOCTYPE html>
<html lang="pt-BR">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Gerador de Or√ßamento Profissional</title>  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>  
    <style>  
        * {  
            box-sizing: border-box;  
            margin: 0;  
            padding: 0;  
        }  
        
        body {  
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;  
            background: #ffffff;  
            min-height: 100vh;  
            padding: 20px;  
            color: #333;  
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }  
          
        .container {  
            max-width: 1000px;  
            width: 100%;
            background: #ffffff;  
            border-radius: 15px;  
            padding: 40px;  
            box-shadow: 0 4px 25px rgba(0, 0, 0, 0.08);  
            border: 1px solid #f0f0f0;  
        }  
          
        .header {  
            text-align: center;  
            margin-bottom: 40px;  
            border-bottom: 3px solid #f5f5f5;  
            padding-bottom: 30px;  
        }  
          
        .title {  
            font-size: 2.5rem;  
            font-weight: 800;  
            color: #333;  
            margin-bottom: 10px;  
        }  
          
        .title-accent {  
            color: #ff8c00;  
        }  
          
        .subtitle {  
            color: #666;  
            font-size: 1.2rem;  
            margin-bottom: 20px;  
        }  
          
        .card {  
            background: #ffffff;  
            border: 2px solid #f0f0f0;  
            border-radius: 15px;  
            margin: 0 auto 25px auto;  
            overflow: hidden;  
            max-width: 900px;
        }  
          
        .card-header {  
            background: linear-gradient(135deg, #fff8f0, #fff4e6);  
            padding: 20px 25px;  
            border-bottom: 1px solid #f0f0f0;  
            text-align: center;  
        }  
          
        .card-title {  
            font-size: 1.3rem;  
            font-weight: 700;  
            color: #333;  
            margin: 0;  
        }  
          
        .card-description {  
            color: #666;  
            font-size: 0.95rem;  
            margin-top: 5px;  
        }  
          
        .card-content {  
            padding: 25px;  
            display: flex;
            flex-direction: column;
            align-items: center;
        }  
          
        .grid {  
            display: grid;  
            gap: 20px;  
            width: 100%;
            max-width: 800px;
        }  
          
        .grid-2 {  
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));  
        }  
          
        .full-width {  
            grid-column: 1 / -1;  
        }  
          
        .form-group {  
            display: flex;  
            flex-direction: column;  
            gap: 8px;  
        }  
          
        .form-group label {  
            font-weight: 600;  
            color: #333;  
            font-size: 0.95rem;
            text-align: left;  
        }  
          
        .form-group input,  
        .form-group textarea {  
            width: 100%;  
            padding: 12px 15px;  
            border: 2px solid #f0f0f0;  
            border-radius: 8px;  
            font-size: 16px;  
            transition: all 0.3s ease;  
            background: white;  
            color: #333;  
        }  
          
        .form-group input:focus,  
        .form-group textarea:focus {  
            outline: none;  
            border-color: #ff8c00;  
            box-shadow: 0 0 0 3px rgba(255, 140, 0, 0.1);  
        }  
          
        .logo-upload {  
            display: flex;  
            align-items: flex-start;  
            gap: 20px;  
            justify-content: center;  
            flex-wrap: wrap;
            width: 100%;
            max-width: 800px;
        }  
          
        .logo-preview {  
            width: 120px;  
            height: 120px;  
            border: 2px dashed #e0e0e0;  
            border-radius: 12px;  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            cursor: pointer;  
            transition: all 0.3s ease;  
            overflow: hidden;  
            background: #fafafa;  
            order: 2;  
            flex-shrink: 0;
        }  
          
        .logo-preview:hover {  
            border-color: #ff8c00;  
            background: #fff8f0;  
        }  
          
        .logo-preview img {  
            max-width: 100%;  
            max-height: 100%;  
            object-fit: contain;  
        }  
          
        .logo-placeholder {  
            text-align: center;  
            color: #888;  
            font-size: 0.8rem;  
            padding: 10px;  
        }  
          
        .company-fields {  
            flex: 1;  
            order: 1;
            min-width: 300px;
        }  
          
        .btn {  
            padding: 12px 20px;  
            border: none;  
            border-radius: 10px;  
            font-size: 1rem;  
            font-weight: 600;  
            cursor: pointer;  
            transition: all 0.3s ease;  
            display: inline-flex;  
            align-items: center;  
            justify-content: center;  
            gap: 8px;  
        }  
          
        .btn:disabled {  
            opacity: 0.6;  
            cursor: not-allowed;  
        }  
          
        .btn-primary {  
            background: linear-gradient(135deg, #ff8c00, #ff9500);  
            color: white;  
        }  
          
        .btn-primary:hover:not(:disabled) {  
            background: linear-gradient(135deg, #e67c00, #ff8c00);  
            transform: translateY(-2px);  
            box-shadow: 0 8px 25px rgba(255, 140, 0, 0.25);  
        }  
          
        .btn-outline {  
            background: transparent;  
            color: #ff8c00;  
            border: 2px solid #ff8c00;  
        }  
          
        .btn-outline:hover:not(:disabled) {  
            background: #ff8c00;  
            color: white;  
            transform: translateY(-2px);  
        }  
          
        .btn-danger {  
            background: #ef4444;  
            color: white;  
            padding: 8px 12px;  
            font-size: 0.9rem;  
        }  
          
        .btn-danger:hover {  
            background: #dc2626;  
        }  
          
        .items-section {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
        }
          
        .item-row {  
            display: grid;  
            grid-template-columns: 1fr auto auto auto auto;  
            gap: 12px;  
            align-items: end;  
            padding: 15px;  
            background: #fafafa;  
            border-radius: 10px;  
            border: 1px solid #f0f0f0;  
            margin-bottom: 10px;  
        }  
          
        .item-subtotal {  
            background: #f8f8f8 !important;  
            color: #666;  
            cursor: not-allowed;  
        }  
          
        .totals-section {  
            background: linear-gradient(135deg, #f8f9fa, #ffffff);  
            border-radius: 12px;  
            padding: 25px;  
            border: 1px solid #e9ecef;  
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
        }  
          
        .total-row {  
            display: flex;  
            justify-content: space-between;  
            align-items: center;  
            padding: 8px 0;  
            font-size: 1.1rem;  
        }  
          
        .total-row.final {  
            border-top: 2px solid #ff8c00;  
            padding-top: 15px;  
            margin-top: 15px;  
            font-size: 1.4rem;  
            font-weight: 700;  
            color: #ff8c00;  
        }  
          
        .action-buttons {  
            display: flex;  
            justify-content: center;  
            gap: 15px;  
            margin-top: 30px;  
            padding-top: 20px;  
            border-top: 2px solid #f5f5f5;
            width: 100%;
        }  
          
        .loading {  
            display: inline-block;  
            width: 20px;  
            height: 20px;  
            border: 3px solid rgba(255,255,255,.3);  
            border-radius: 50%;  
            border-top-color: #fff;  
            animation: spin 1s ease-in-out infinite;  
        }  
          
        @keyframes spin {  
            to { transform: rotate(360deg); }  
        }  
          
        .alert {  
            padding: 15px 20px;  
            border-radius: 10px;  
            margin: 15px 0;  
            font-weight: 500;  
        }  
          
        .alert-warning {  
            background: #fff3cd;  
            border: 1px solid #ffecb5;  
            color: #856404;  
        }

        .add-item-container {
            text-align: center;
            margin-top: 20px;
            width: 100%;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 20px;
            align-items: start;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }
          
        @media (max-width: 768px) {  
            body {
                padding: 10px;
            }
            
            .container {  
                padding: 20px;  
            }  
              
            .title {  
                font-size: 2rem;  
            }  
              
            .item-row {  
                grid-template-columns: 1fr;  
                gap: 15px;  
            }  
              
            .action-buttons {  
                flex-direction: column;  
            }  
              
            .logo-upload {  
                flex-direction: column;  
                align-items: center;
            }  
              
            .company-fields {  
                order: 2;  
                width: 100%;
            }  
              
            .logo-preview {  
                order: 1;  
                margin: 0 auto 20px auto;  
            }
            
            .summary-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }  
    </style>
</head>  
<body>  
    <div class="container">  
        <div class="header">  
            <h1 class="title">Gerador de <span class="title-accent">Or√ßamento</span></h1>  
            <p class="subtitle">Crie or√ßamentos profissionais facilmente e com poucos cliques.</p>  
        </div>  

        <!-- Dados da Empresa -->  
        <div class="card">  
            <div class="card-header">  
                <h2 class="card-title">Dados da Sua Empresa</h2>  
                <p class="card-description">Informa√ß√µes que aparecer√£o no cabe√ßalho do or√ßamento</p>  
            </div>  
            <div class="card-content">  
                <div class="logo-upload">  
                    <div class="company-fields">  
                        <div class="grid grid-2">  
                            <div class="form-group full-width">  
                                <label for="empresaNome">Nome da Empresa *</label>  
                                <input type="text" id="empresaNome" placeholder="Sua Empresa LTDA" required>  
                            </div>  
                            <div class="form-group">  
                                <label for="empresaDoc">CNPJ / CPF</label>  
                                <input type="text" id="empresaDoc" placeholder="00.000.000/0001-00">  
                            </div>  
                            <div class="form-group">  
                                <label for="empresaTel">Telefone</label>  
                                <input type="tel" id="empresaTel" placeholder="(11) 99999-9999">  
                            </div>  
                            <div class="form-group full-width">  
                                <label for="empresaEmail">Email</label>  
                                <input type="email" id="empresaEmail" placeholder="contato@suaempresa.com">  
                            </div>  
                            <div class="form-group">  
                                <label for="empresaCidade">Cidade *</label>  
                                <input type="text" id="empresaCidade" placeholder="S√£o Paulo" required>  
                            </div>  
                            <div class="form-group">  
                                <label for="empresaEstado">Estado (UF) *</label>  
                                <input type="text" id="empresaEstado" placeholder="SP" maxlength="2" required>  
                            </div>  
                            <div class="form-group full-width">  
                                <label for="empresaEnd">Endere√ßo Completo</label>  
                                <input type="text" id="empresaEnd" placeholder="Rua Exemplo, 123, Bairro">  
                            </div>  
                        </div>  
                    </div>  
                    <div>  
                        <div class="form-group">  
                            <label>Logo da Empresa</label>  
                            <div class="logo-preview" id="logoPreview" onclick="document.getElementById('logoInput').click()">  
                                <div class="logo-placeholder">  
                                    Clique para<br>adicionar logo  
                                </div>  
                            </div>  
                            <input type="file" id="logoInput" accept="image/*" style="display: none;">  
                        </div>  
                    </div>  
                </div>  
            </div>  
        </div>  
          
        <!-- Dados do Cliente -->  
        <div class="card">  
            <div class="card-header">  
                <h2 class="card-title">Dados do Cliente</h2>  
                <p class="card-description">Informa√ß√µes do destinat√°rio do or√ßamento</p>  
            </div>  
            <div class="card-content">  
                <div class="grid grid-2">  
                    <div class="form-group">  
                        <label for="clienteNome">Nome Completo *</label>  
                        <input type="text" id="clienteNome" placeholder="Nome do Cliente" required>  
                    </div>  
                    <div class="form-group">  
                        <label for="clienteEmail">Email</label>  
                        <input type="email" id="clienteEmail" placeholder="email@cliente.com">  
                    </div>  
                    <div class="form-group">  
                        <label for="clienteTel">Telefone</label>  
                        <input type="tel" id="clienteTel" placeholder="(21) 98888-8888">  
                    </div>  
                    <div class="form-group">  
                        <label for="clienteEnd">Endere√ßo</label>  
                        <input type="text" id="clienteEnd" placeholder="Endere√ßo do Cliente (Opcional)">  
                    </div>  
                </div>  
            </div>  
        </div>  
          
        <!-- Itens do Or√ßamento -->  
        <div class="card">  
            <div class="card-header">  
                <h2 class="card-title">Itens do Or√ßamento</h2>  
                <p class="card-description">Adicione os produtos ou servi√ßos</p>  
            </div>  
            <div class="card-content">  
                <div class="items-section">
                    <div id="itensContainer"></div>  
                    <div class="add-item-container">
                        <button type="button" class="btn btn-outline" onclick="adicionarItem()">  
                            Adicionar Item  
                        </button>  
                    </div>
                </div>
            </div>  
        </div>  
          
        <!-- Resumo e Pagamento -->  
        <div class="card">  
            <div class="card-header">  
                <h2 class="card-title">Resumo e Pagamento</h2>  
                <p class="card-description">Totais e observa√ß√µes</p>  
            </div>  
            <div class="card-content">  
                <div class="summary-grid">  
                    <div class="form-group">  
                        <label for="observacoes">Observa√ß√µes</label>  
                        <textarea id="observacoes" rows="6" placeholder="Ex: Condi√ß√µes de pagamento, validade da proposta, etc."></textarea>  
                    </div>  
                    <div>  
                        <div class="totals-section">  
                            <div class="total-row">  
                                <span>Subtotal:</span>  
                                <span id="subtotalValue">R$ 0,00</span>  
                            </div>  
                            <div class="total-row">  
                                <span>Desconto (R$):</span>  
                                <input type="number" id="desconto" value="0" step="0.01" style="width: 100px; text-align: right; border: 1px solid #ddd; border-radius: 5px; padding: 5px;">  
                            </div>  
                            <div class="total-row final">  
                                <span>TOTAL:</span>  
                                <span id="totalValue">R$ 0,00</span>  
                            </div>  
                        </div>  
                    </div>  
                </div>  
            </div>  
        </div>  
          
        <div class="action-buttons">  
            <button type="button" class="btn btn-outline" onclick="limparFormulario()">  
                Limpar Formul√°rio  
            </button>  
            <button type="button" class="btn btn-primary" id="gerarPdfBtn" onclick="gerarPDF()">  
                Gerar PDF  
            </button>  
        </div>  
    </div>  

    <script>  
        let logoBase64 = null;  
        let itemCounter = 0;  
          
        // Formata√ß√£o de moeda  
        const formatCurrency = (value) => {  
            return new Intl.NumberFormat('pt-BR', {  
                style: 'currency',  
                currency: 'BRL'  
            }).format(value || 0);  
        };  
          
        // Fun√ß√£o para redimensionar imagem mantendo propor√ß√£o  
        function resizeImageProportionally(img, maxWidth, maxHeight) {  
            const canvas = document.createElement('canvas');  
            const ctx = canvas.getContext('2d');  
              
            // Calcular dimens√µes mantendo propor√ß√£o  
            let { width, height } = img;  
            const aspectRatio = width / height;  
              
            if (width > height) {  
                if (width > maxWidth) {  
                    width = maxWidth;  
                    height = width / aspectRatio;  
                }  
            } else {  
                if (height > maxHeight) {  
                    height = maxHeight;  
                    width = height * aspectRatio;  
                }  
            }  
              
            canvas.width = width;  
            canvas.height = height;  
              
            ctx.drawImage(img, 0, 0, width, height);  
            return canvas.toDataURL('image/jpeg', 0.8);  
        }  
          
        // Adicionar item ao or√ßamento  
        function adicionarItem() {  
            itemCounter++;  
            const container = document.getElementById('itensContainer');  
            const itemDiv = document.createElement('div');  
            itemDiv.className = 'item-row';  
            itemDiv.id = `item-${itemCounter}`;  
              
            itemDiv.innerHTML = `  
                <div class="form-group">  
                    <label>Descri√ß√£o</label>  
                    <input type="text" class="item-descricao" placeholder="Descri√ß√£o do produto/servi√ßo" onchange="calcularTotais()">  
                </div>  
                <div class="form-group" style="width: 80px;">  
                    <label>Qtd</label>  
                    <input type="number" class="item-quantidade" value="1" min="0" step="0.01" onchange="calcularTotais()">  
                </div>  
                <div class="form-group" style="width: 120px;">  
                    <label>Valor Unit.</label>  
                    <input type="number" class="item-valor" placeholder="0,00" step="0.01" onchange="calcularTotais()">  
                </div>  
                <div class="form-group" style="width: 120px;">  
                    <label>Subtotal</label>  
                    <input type="text" class="item-subtotal" readonly>  
                </div>  
                <div class="form-group">  
                    <label>&nbsp;</label>  
                    <button type="button" class="btn btn-danger" onclick="removerItem(${itemCounter})">√ó</button>  
                </div>  
            `;  
              
            container.appendChild(itemDiv);  
            calcularTotais();  
        }  
          
        // Remover item  
        function removerItem(id) {  
            const item = document.getElementById(`item-${id}`);  
            if (item) {  
                item.remove();  
                calcularTotais();  
            }  
        }  
          
        // Calcular totais  
        function calcularTotais() {  
            let subtotal = 0;  
              
            document.querySelectorAll('.item-row').forEach(row => {  
                const quantidade = parseFloat(row.querySelector('.item-quantidade').value) || 0;  
                const valor = parseFloat(row.querySelector('.item-valor').value) || 0;  
                const itemSubtotal = quantidade * valor;  
                  
                row.querySelector('.item-subtotal').value = formatCurrency(itemSubtotal);  
                subtotal += itemSubtotal;  
            });  
              
            const desconto = parseFloat(document.getElementById('desconto').value) || 0;  
            const total = subtotal - desconto;  
              
            document.getElementById('subtotalValue').textContent = formatCurrency(subtotal);  
            document.getElementById('totalValue').textContent = formatCurrency(total);  
        }  
          
        // Gerar PDF  
        async function gerarPDF() {  
            const btn = document.getElementById('gerarPdfBtn');  
            const originalText = btn.innerHTML;  
              
            // Valida√ß√µes  
            const empresaNome = document.getElementById('empresaNome').value.trim();  
            const clienteNome = document.getElementById('clienteNome').value.trim();  
            const empresaCidade = document.getElementById('empresaCidade').value.trim();  
            const empresaEstado = document.getElementById('empresaEstado').value.trim();  
              
            if (!empresaNome || !clienteNome) {  
                alert('Nome da empresa e nome do cliente s√£o obrigat√≥rios!');  
                return;  
            }  
              
            // Loading  
            btn.disabled = true;  
            btn.innerHTML = '<span class="loading"></span> Gerando PDF...';  
              
            try {  
                const { jsPDF } = window.jspdf;  
                const doc = new jsPDF();  
                const pageWidth = doc.internal.pageSize.width;  
                const pageHeight = doc.internal.pageSize.height;  
                let yPosition = 20;  
                  
                // Header com logo na direita se existir  
                if (logoBase64) {  
                    // Criar uma imagem tempor√°ria para obter dimens√µes  
                    const tempImg = new Image();  
                    tempImg.onload = function() {  
                        // Calcular dimens√µes proporcionais para o PDF  
                        const maxLogoWidth = 30;  
                        const maxLogoHeight = 30;  
                        let logoWidth = this.width;  
                        let logoHeight = this.height;  
                          
                        // Redimensionar mantendo propor√ß√£o  
                        const aspectRatio = logoWidth / logoHeight;  
                        if (logoWidth > logoHeight) {  
                            logoWidth = maxLogoWidth;  
                            logoHeight = logoWidth / aspectRatio;  
                        } else {  
                            logoHeight = maxLogoHeight;  
                            logoWidth = logoHeight * aspectRatio;  
                        }  
                          
                        // Posicionar logo no canto superior direito  
                        const logoX = pageWidth - logoWidth - 15;  
                        doc.addImage(logoBase64, 'JPEG', logoX, 15, logoWidth, logoHeight);  
                    };  
                    tempImg.src = logoBase64;  
                      
                    // Adicionar logo imediatamente com dimens√µes padr√£o  
                    doc.addImage(logoBase64, 'JPEG', pageWidth - 45, 15, 30, 30);  
                }  
                  
                // Dados da empresa - sempre come√ßando na esquerda  
                doc.setFontSize(16);  
                doc.setFont(undefined, 'bold');  
                doc.text(empresaNome, 15, 25);  
                  
                doc.setFontSize(10);  
                doc.setFont(undefined, 'normal');  
                const empresaDoc = document.getElementById('empresaDoc').value;  
                const empresaTel = document.getElementById('empresaTel').value;  
                const empresaEmail = document.getElementById('empresaEmail').value;  
                const empresaEnd = document.getElementById('empresaEnd').value;  
                  
                let empresaY = 32;  
                if (empresaEnd) {  
                    doc.text(empresaEnd, 15, empresaY);  
                    empresaY += 6;  
                }  
                if (empresaDoc) {  
                    doc.text(`Documento: ${empresaDoc}`, 15, empresaY);  
                    empresaY += 6;  
                }  
                if (empresaTel) {  
                    doc.text(`Telefone: ${empresaTel}`, 15, empresaY);  
                    empresaY += 6;  
                }  
                if (empresaEmail) {  
                    doc.text(`Email: ${empresaEmail}`, 15, empresaY);  
                    empresaY += 6;  
                }  
                  
                yPosition = Math.max(65, empresaY + 10);  
                  
                // T√≠tulo e data  
                doc.setFontSize(20);  
                doc.setFont(undefined, 'bold');  
                doc.text('OR√áAMENTO', 15, yPosition);  
                  
                doc.setFontSize(10);  
                doc.setFont(undefined, 'normal');  
                doc.text(`Data: ${new Date().toLocaleDateString('pt-BR')}`, pageWidth - 60, yPosition);  
                  
                yPosition += 15;  
                  
                // Dados do cliente  
                doc.setFontSize(12);  
                doc.setFont(undefined, 'bold');  
                doc.text('DADOS DO CLIENTE', 15, yPosition);  
                yPosition += 8;  
                  
                doc.setFontSize(10);  
                doc.setFont(undefined, 'normal');  
                  
                const clienteEmail = document.getElementById('clienteEmail').value;  
                const clienteTel = document.getElementById('clienteTel').value;  
                const clienteEnd = document.getElementById('clienteEnd').value;  
                  
                doc.text(`Nome: ${clienteNome}`, 15, yPosition);  
                if (clienteEmail) doc.text(`Email: ${clienteEmail}`, pageWidth/2, yPosition);  
                yPosition += 6;  
                if (clienteTel) doc.text(`Telefone: ${clienteTel}`, 15, yPosition);  
                if (clienteEnd) doc.text(`Endere√ßo: ${clienteEnd}`, pageWidth/2, yPosition);  
                  
                yPosition += 15;  
                  
                // Itens (tabela manual)  
                doc.setFontSize(12);  
                doc.setFont(undefined, 'bold');  
                doc.text('ITENS DO OR√áAMENTO', 15, yPosition);  
                yPosition += 10;  
                  
                // Cabe√ßalho da tabela  
                doc.setFontSize(9);  
                doc.text('Descri√ß√£o', 15, yPosition);  
                doc.text('Qtd', 120, yPosition);  
                doc.text('Valor Unit.', 140, yPosition);  
                doc.text('Subtotal', 170, yPosition);  
                yPosition += 5;  
                  
                // Linha separadora  
                doc.line(15, yPosition, 195, yPosition);  
                yPosition += 5;  
                  
                // Itens  
                let subtotal = 0;  
                doc.setFont(undefined, 'normal');  
                  
                document.querySelectorAll('.item-row').forEach(row => {  
                    const descricao = row.querySelector('.item-descricao').value;  
                    const quantidade = parseFloat(row.querySelector('.item-quantidade').value) || 0;  
                    const valor = parseFloat(row.querySelector('.item-valor').value) || 0;  
                    const itemSubtotal = quantidade * valor;  
                    subtotal += itemSubtotal;  
                      
                    if (descricao.trim()) {  
                        doc.text(descricao.substring(0, 40), 15, yPosition);  
                        doc.text(quantidade.toString(), 120, yPosition);  
                        doc.text(formatCurrency(valor), 140, yPosition);  
                        doc.text(formatCurrency(itemSubtotal), 170, yPosition);  
                        yPosition += 6;  
                    }  
                });  
                  
                yPosition += 10;  
                  
                // Totais  
                const desconto = parseFloat(document.getElementById('desconto').value) || 0;  
                const total = subtotal - desconto;  
                  
                const totalsX = 140;  
                doc.setFontSize(11);  
                doc.setFont(undefined, 'normal');  
                doc.text('Subtotal:', totalsX, yPosition);  
                doc.text(formatCurrency(subtotal), 170, yPosition);  
                yPosition += 8;  
                  
                if (desconto > 0) {  
                    doc.text('Desconto:', totalsX, yPosition);  
                    doc.text(formatCurrency(desconto), 170, yPosition);  
                    yPosition += 8;  
                }  
                  
                doc.setFont(undefined, 'bold');  
                doc.setFontSize(14);  
                doc.text('TOTAL:', totalsX, yPosition);  
                doc.text(formatCurrency(total), 170, yPosition);  
                yPosition += 15;  
                  
                // Observa√ß√µes  
                const observacoes = document.getElementById('observacoes').value.trim();  
                if (observacoes) {  
                    doc.setFont(undefined, 'bold');  
                    doc.setFontSize(12);  
                    doc.text('Observa√ß√µes:', 15, yPosition);  
                    yPosition += 8;  
                      
                    doc.setFont(undefined, 'normal');  
                    doc.setFontSize(10);  
                    const splitObservacoes = doc.splitTextToSize(observacoes, pageWidth - 30);  
                    doc.text(splitObservacoes, 15, yPosition);  
                    yPosition += splitObservacoes.length * 5 + 10;  
                }  
                  
                // Rodap√©  
                doc.setFont(undefined, 'normal');  
                doc.setFontSize(8);  
                doc.text('Or√ßamento v√°lido por 30 dias a partir da data de emiss√£o.', 15, pageHeight - 15);  
                doc.text(`Gerado em ${new Date().toLocaleString('pt-BR')}`, 15, pageHeight - 10);  
                  
                // Salvar PDF  
                const nomeArquivo = `Orcamento_${clienteNome.replace(/\s+/g, '_')}_${new Date().toISOString().slice(0,10)}.pdf`;  
                doc.save(nomeArquivo);  
                  
            } catch (error) {  
                console.error('Erro ao gerar PDF:', error);  
                alert('Erro ao gerar PDF: ' + error.message);  
            } finally {  
                // Restaurar bot√£o  
                btn.disabled = false;  
                btn.innerHTML = originalText;  
            }  
        }  
          
        // Limpar formul√°rio  
        function limparFormulario() {  
            if (confirm('Tem certeza que deseja limpar todos os campos?')) {  
                // Limpar todos os inputs  
                document.querySelectorAll('input:not([type="file"]), textarea').forEach(input => {  
                    if (input.type === 'checkbox') {  
                        input.checked = false;  
                    } else {  
                        input.value = input.type === 'number' && input.id === 'desconto' ? '0' : '';  
                    }  
                });  
                  
                // Limpar logo  
                logoBase64 = null;  
                document.getElementById('logoPreview').innerHTML = `  
                    <div class="logo-placeholder">  
                        Clique para<br>adicionar logo  
                    </div>  
                `;  
                  
                // Limpar itens  
                document.getElementById('itensContainer').innerHTML = '';  
                itemCounter = 0;  
                  
                // Adicionar um item inicial  
                adicionarItem();  
                  
                // Recalcular totais  
                calcularTotais();  
            }  
        }  
          
        function aplicarMascaraTelefone(input) {  
            let valor = input.value.replace(/\D/g, '');  
            if (valor.length <= 11) {  
                valor = valor.replace(/^(\d{2})(\d{5})(\d{4})$/, '($1) $2-$3');  
                valor = valor.replace(/^(\d{2})(\d{4})(\d{4})$/, '($1) $2-$3');  
                valor = valor.replace(/^(\d{2})(\d{1,5})$/, '($1) $2');  
                valor = valor.replace(/^(\d{2})$/, '($1');  
            }  
            input.value = valor;  
        }  
          
        // Event listeners  
        document.addEventListener('DOMContentLoaded', function() {  
            // Upload de logo  
            document.getElementById('logoInput').addEventListener('change', function(e) {  
                const file = e.target.files[0];  
                if (file) {  
                    const reader = new FileReader();  
                    reader.onload = function(e) {  
                        const img = new Image();  
                        img.onload = function() {  
                            // Redimensionar a imagem mantendo propor√ß√£o  
                            logoBase64 = resizeImageProportionally(this, 300, 300);  
                            document.getElementById('logoPreview').innerHTML = `<img src="${logoBase64}" alt="Logo">`;  
                        };  
                        img.src = e.target.result;  
                    };  
                    reader.readAsDataURL(file);  
                }  
            });  
              
            // Event listener para desconto  
            document.getElementById('desconto').addEventListener('input', calcularTotais);  
              
            // M√°scaras para telefones  
            document.getElementById('empresaTel').addEventListener('input', function() {  
                aplicarMascaraTelefone(this);  
            });  
              
            document.getElementById('clienteTel').addEventListener('input', function() {  
                aplicarMascaraTelefone(this);  
            });  
              
            // M√°scara para CNPJ/CPF  
            document.getElementById('empresaDoc').addEventListener('input', function() {  
                let valor = this.value.replace(/\D/g, '');  
                if (valor.length <= 11) {  
                    // CPF  
                    valor = valor.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');  
                    valor = valor.replace(/(\d{3})(\d{3})(\d{3})/, '$1.$2.$3');  
                    valor = valor.replace(/(\d{3})(\d{3})/, '$1.$2');  
                } else {  
                    // CNPJ  
                    valor = valor.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, '$1.$2.$3/$4-$5');  
                    valor = valor.replace(/(\d{2})(\d{3})(\d{3})(\d{4})/, '$1.$2.$3/$4');  
                    valor = valor.replace(/(\d{2})(\d{3})(\d{3})/, '$1.$2.$3');  
                }  
                this.value = valor;  
            });  
              
            // Inicializar com um item  
            adicionarItem();  
            calcularTotais();  
        });  
    </script>

</body>  
</html>